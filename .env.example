# ═══════════════════════════════════════════════════════════════════
# PostgreSQL Database Configuration
# ═══════════════════════════════════════════════════════════════════
POSTGRES_USER=n8n
POSTGRES_PASSWORD=n8n_password

# Database Names
# - DB_POSTGRESDB_DATABASE: usado por N8N containers + init-databases.sh
# - CHATBOT_DATABASE: usado por init-databases.sh para criar database do projeto
# Altere aqui se quiser outros nomes (ex: n8n_prod, chatbot_prod)
DB_POSTGRESDB_DATABASE=n8n
CHATBOT_DATABASE=chatbot

# Connection Settings
DB_POSTGRESDB_HOST=postgres
DB_POSTGRESDB_PORT=5432
DB_POSTGRESDB_CONNECTION_TIMEOUT=60000
DB_POSTGRESDB_SSL_ENABLED=false

# ═══════════════════════════════════════════════════════════════════
# Redis Queue Configuration
# ═══════════════════════════════════════════════════════════════════
QUEUE_BULL_REDIS_HOST=redis
QUEUE_BULL_REDIS_PORT=6379
QUEUE_BULL_REDIS_DB=0
# Senha do Redis (OBRIGATÓRIO)
# Gere uma senha segura com: openssl rand -base64 32
QUEUE_BULL_REDIS_PASSWORD=GERE_SUA_SENHA_AQUI

# ═══════════════════════════════════════════════════════════════════
# N8N General Configuration
# ═══════════════════════════════════════════════════════════════════
# Define o Host do Editor do N8N (localhost para desenvolvimento)
N8N_HOST=localhost

# Define a Porta HTTP para o N8N Editor (padrão: 5678)
N8N_PORT=5678

# Protocolo usado (http para local, https para produção)
N8N_PROTOCOL=http

# URL Base do Editor N8N (DEVE terminar com /)
N8N_EDITOR_BASE_URL=http://localhost:5678/

# URL do Webhook (porta 5679 exposta pelo container webhook, DEVE terminar com /)
WEBHOOK_URL=http://localhost:5679/

# Prefixo do caminho dos webhooks (ex: webhook -> /webhook/[path], data -> /data/[path])
N8N_ENDPOINT_WEBHOOK=webhook

# ═══════════════════════════════════════════════════════════════════
# N8N Encryption Key (CRÍTICO!)
# ═══════════════════════════════════════════════════════════════════
# ATENÇÃO: Editor, Webhook e Worker DEVEM usar a MESMA chave!
# Gere uma nova chave com: openssl rand -hex 16
# Nunca compartilhe esta chave publicamente!
N8N_ENCRYPTION_KEY=GERE_SUA_CHAVE_AQUI

# ═══════════════════════════════════════════════════════════════════
# N8N Queue Mode Configuration
# ═══════════════════════════════════════════════════════════════════
EXECUTIONS_MODE=queue
QUEUE_HEALTH_CHECK_ACTIVE=true
OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true

# ═══════════════════════════════════════════════════════════════════
# Timezone Configuration
# ═══════════════════════════════════════════════════════════════════
GENERIC_TIMEZONE=America/Sao_Paulo
TZ=America/Sao_Paulo

# ═══════════════════════════════════════════════════════════════════
# N8N Execution Configuration
# ═══════════════════════════════════════════════════════════════════
EXECUTIONS_TIMEOUT=3600
EXECUTIONS_TIMEOUT_MAX=7200
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_ON_PROGRESS=true
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true

# ═══════════════════════════════════════════════════════════════════
# N8N Auto-Pruning (Limpeza Automática de Execuções)
# ═══════════════════════════════════════════════════════════════════
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=168
EXECUTIONS_DATA_PRUNE_HARD_DELETE_INTERVAL=15
EXECUTIONS_DATA_PRUNE_SOFT_DELETE_INTERVAL=60
EXECUTIONS_DATA_PRUNE_MAX_COUNT=10000

# ═══════════════════════════════════════════════════════════════════
# N8N Security Configuration
# ═══════════════════════════════════════════════════════════════════
N8N_PAYLOAD_SIZE_MAX=32
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
N8N_BLOCK_ENV_ACCESS_IN_NODE=true

# ═══════════════════════════════════════════════════════════════════
# N8N Logging & Monitoring
# ═══════════════════════════════════════════════════════════════════
N8N_LOG_LEVEL=info
N8N_LOG_OUTPUT=console
N8N_METRICS=true
N8N_DIAGNOSTICS_ENABLED=false

# ═══════════════════════════════════════════════════════════════════
# N8N Community Packages
# ═══════════════════════════════════════════════════════════════════
N8N_COMMUNITY_PACKAGES_ENABLED=true
N8N_REINSTALL_MISSING_PACKAGES=true
NODE_FUNCTION_ALLOW_BUILTIN=*
NODE_FUNCTION_ALLOW_EXTERNAL=moment,lodash,axios

# ═══════════════════════════════════════════════════════════════════
# N8N Task Runners
# ═══════════════════════════════════════════════════════════════════
N8N_RUNNERS_ENABLED=true
N8N_RUNNERS_MODE=internal

# ═══════════════════════════════════════════════════════════════════
# N8N UI Configuration
# ═══════════════════════════════════════════════════════════════════
N8N_VERSION_NOTIFICATIONS_ENABLED=false
N8N_PUBLIC_API_SWAGGERUI_DISABLED=false
N8N_TEMPLATES_ENABLED=true
N8N_ONBOARDING_FLOW_DISABLED=false
N8N_WORKFLOW_TAGS_DISABLED=false

# ═══════════════════════════════════════════════════════════════════
# PgAdmin Configuration
# ═══════════════════════════════════════════════════════════════════
PGADMIN_DEFAULT_EMAIL=admin@chatbot.com
PGADMIN_DEFAULT_PASSWORD=Admin@123
PGADMIN_CONFIG_SERVER_MODE=False

# ═══════════════════════════════════════════════════════════════════
# Frontend Configuration
# ═══════════════════════════════════════════════════════════════════
# URL da API N8N (webhook) - usada pelo frontend para enviar mensagens
VITE_API_URL=http://localhost:5679/webhook

# Chave de API para autenticação nos webhooks
# Gere uma nova com: openssl rand -base64 24
VITE_API_KEY=GERE_SUA_CHAVE_AQUI
